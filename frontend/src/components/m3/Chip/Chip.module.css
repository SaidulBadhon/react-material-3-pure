/**
 * @license
 * Copyright 2023 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */

/* ==========================================================================
   CHIP SET
   ========================================================================== */

.chipSet {
  display: flex;
  flex-wrap: wrap;
  gap: 8px;
}

/* ==========================================================================
   BASE CHIP
   ========================================================================== */

.chip {
  position: relative;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  height: 32px;
  box-sizing: border-box;
  border: none;
  border-radius: 8px;
  outline: none;
  padding: 0;
  margin: 0;
  background: transparent;
  cursor: pointer;
  font-family: var(--md-sys-typescale-label-large-font, var(--md-ref-typeface-plain, Roboto, sans-serif));
  font-size: var(--md-sys-typescale-label-large-size, 14px);
  font-weight: var(--md-sys-typescale-label-large-weight, 500);
  line-height: var(--md-sys-typescale-label-large-line-height, 20px);
  letter-spacing: var(--md-sys-typescale-label-large-tracking, 0.1px);
  text-decoration: none;
  user-select: none;
  -webkit-tap-highlight-color: transparent;
  /* For multi-action chips */
  isolation: isolate;
}

/* Primary action (button or anchor inside multi-action chips) */
.primaryAction {
  display: inline-flex;
  align-items: center;
  height: 100%;
  padding: 0 16px;
  padding-inline-start: 16px;
  padding-inline-end: 16px;
  border: none;
  border-radius: inherit;
  background: transparent;
  cursor: pointer;
  font: inherit;
  color: inherit;
  text-decoration: none;
  outline: none;
  -webkit-tap-highlight-color: transparent;
}

.hasIcon .primaryAction {
  padding-inline-start: 8px;
}

.hasTrailing .primaryAction {
  padding-inline-end: 8px;
}

/* ==========================================================================
   OUTLINE & BACKGROUND
   ========================================================================== */

.outline {
  position: absolute;
  inset: 0;
  border-radius: inherit;
  pointer-events: none;
  border: 1px solid var(--md-sys-color-outline);
}

.selected .outline {
  border-color: transparent;
}

/* Elevated chips have elevation instead of outline */
.elevated .outline {
  border-color: transparent;
}

/* Elevation for elevated chips */
.elevation {
  position: absolute;
  inset: 0;
  border-radius: inherit;
  pointer-events: none;
  background: var(--md-sys-color-surface-container-low);
  box-shadow: var(--md-sys-elevation-1,
    0 1px 2px 0 rgba(0, 0, 0, 0.3),
    0 1px 3px 1px rgba(0, 0, 0, 0.15)
  );
  z-index: -2;
}

/* Selected state background for filter/input chips */
.filter.selected::before,
.input.selected::before {
  content: '';
  position: absolute;
  inset: 0;
  border-radius: inherit;
  background: var(--md-sys-color-secondary-container);
  z-index: -1;
}

/* ==========================================================================
   FOCUS RING
   ========================================================================== */

.focusRing {
  position: absolute;
  inset: -2px;
  border-radius: 10px;
  pointer-events: none;
  outline: 2px solid var(--md-sys-color-secondary);
  outline-offset: 1px;
  opacity: 0;
  transition: opacity 0.15s ease;
}

.chip:focus-visible .focusRing,
.primaryAction:focus-visible ~ .focusRing,
.primaryAction:focus-visible + .focusRing {
  opacity: 1;
}

/* For chips where primary action is inside */
.input .primaryAction:focus-visible ~ .focusRing,
.filter .primaryAction:focus-visible ~ .focusRing {
  opacity: 1;
}

/* For multi-action chips, show focus ring on container */
.input:has(.primaryAction:focus-visible) > .focusRing,
.filter:has(.primaryAction:focus-visible) > .focusRing {
  opacity: 1;
}

/* ==========================================================================
   RIPPLE
   ========================================================================== */

.ripple {
  position: absolute;
  inset: 0;
  border-radius: inherit;
  pointer-events: none;
  overflow: hidden;
  z-index: 0;
  -webkit-tap-highlight-color: transparent;
}

.ripple::before {
  content: '';
  opacity: 0;
  position: absolute;
  background-color: var(--md-sys-color-on-surface);
  inset: 0;
  transition: opacity 15ms linear, background-color 15ms linear;
}

.ripple::after {
  content: '';
  opacity: 0;
  position: absolute;
  background: radial-gradient(
    closest-side,
    var(--md-sys-color-on-surface) max(calc(100% - 70px), 65%),
    transparent 100%
  );
  transform-origin: center center;
  transition: opacity 375ms linear;
}

.ripple.hovered::before {
  opacity: 0.08;
}

.ripple.pressed::after {
  opacity: 0.12;
  transition-duration: 105ms;
}

/* Selected ripple colors */
.ripple.selected::before {
  background-color: var(--md-sys-color-on-secondary-container);
}

.ripple.selected::after {
  background: radial-gradient(
    closest-side,
    var(--md-sys-color-on-secondary-container) max(calc(100% - 70px), 65%),
    transparent 100%
  );
}

/* ==========================================================================
   TOUCH TARGET
   ========================================================================== */

.touch {
  position: absolute;
  inset: 50% 0 0 50%;
  transform: translate(-50%, -50%);
  width: max(48px, 100%);
  height: 48px;
  border-radius: inherit;
}

/* ==========================================================================
   ICONS
   ========================================================================== */

.leadingIcon {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  width: 18px;
  height: 18px;
  margin-inline-end: 8px;
  color: var(--md-sys-color-primary);
}

.leadingIcon svg {
  width: 18px;
  height: 18px;
}

.selected .leadingIcon {
  color: var(--md-sys-color-on-secondary-container);
}

.disabled .leadingIcon {
  color: var(--md-sys-color-on-surface);
  opacity: 0.38;
}

/* Avatar styling */
.avatar .leadingIcon {
  width: 24px;
  height: 24px;
  border-radius: 50%;
  overflow: hidden;
}

.avatar .leadingIcon svg,
.avatar .leadingIcon img {
  width: 24px;
  height: 24px;
  object-fit: cover;
}

/* Trailing (remove) icon */
.trailingAction {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  width: 32px;
  height: 100%;
  padding: 0;
  border: none;
  border-radius: 0 inherit inherit 0;
  background: transparent;
  cursor: pointer;
  outline: none;
  position: relative;
}

.trailingAction:focus-visible::before {
  content: '';
  position: absolute;
  inset: 4px;
  border-radius: 50%;
  outline: 2px solid var(--md-sys-color-secondary);
}

.trailingIcon {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  width: 18px;
  height: 18px;
  color: var(--md-sys-color-on-surface-variant);
  transition: color 0.15s ease;
}

.trailingIcon svg {
  width: 18px;
  height: 18px;
}

.trailingAction:hover .trailingIcon {
  color: var(--md-sys-color-on-surface);
}

.disabled .trailingAction {
  cursor: default;
}

.disabled .trailingIcon {
  color: var(--md-sys-color-on-surface);
  opacity: 0.38;
}

/* ==========================================================================
   LABEL
   ========================================================================== */

.labelText {
  position: relative;
  z-index: 1;
  color: var(--md-sys-color-on-surface);
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}

.selected .labelText {
  color: var(--md-sys-color-on-secondary-container);
}

.disabled .labelText {
  color: var(--md-sys-color-on-surface);
  opacity: 0.38;
}

/* ==========================================================================
   ASSIST CHIP
   ========================================================================== */

.assist {
  padding-inline: 16px;
}

.assist.hasIcon {
  padding-inline-start: 8px;
}

/* ==========================================================================
   FILTER CHIP
   ========================================================================== */

.filter {
  padding: 0;
}

.filter .primaryAction {
  padding-inline: 16px;
}

.filter.hasIcon .primaryAction {
  padding-inline-start: 8px;
}

.filter.hasTrailing .primaryAction {
  padding-inline-end: 8px;
}

/* ==========================================================================
   INPUT CHIP
   ========================================================================== */

.input {
  padding: 0;
}

.input .primaryAction {
  padding-inline: 12px;
}

.input.hasIcon .primaryAction {
  padding-inline-start: 4px;
}

/* Input chips always have trailing (remove) button */
.input .trailingAction {
  padding-inline-end: 8px;
  padding-inline-start: 0;
  width: 26px;
}

/* ==========================================================================
   SUGGESTION CHIP
   ========================================================================== */

.suggestion {
  /* Same as assist chip - uses assist chip styling via AssistChip component */
  padding-inline: 16px;
}

/* ==========================================================================
   STATES
   ========================================================================== */

/* Disabled */
.disabled {
  cursor: default;
  pointer-events: none;
}

.disabled .outline {
  border-color: var(--md-sys-color-on-surface);
  opacity: 0.12;
}

.disabled .elevation {
  box-shadow: var(--md-sys-elevation-0, none);
  opacity: 0.12;
}

/* Soft disabled (still focusable) */
.softDisabled {
  cursor: default;
}

.softDisabled .labelText,
.softDisabled .leadingIcon,
.softDisabled .trailingIcon {
  opacity: 0.38;
}

/* Link */
.link {
  text-decoration: none;
}

/* ==========================================================================
   ANIMATION
   ========================================================================== */

/* Icon animation for filter chips */
.filter .leadingIcon {
  transform-origin: center;
  animation: chip-icon-appear 0.15s ease forwards;
}

@keyframes chip-icon-appear {
  from {
    transform: scale(0);
    opacity: 0;
  }
  to {
    transform: scale(1);
    opacity: 1;
  }
}

/* Chip remove animation */
@keyframes chip-exit {
  from {
    opacity: 1;
    transform: scale(1);
  }
  to {
    opacity: 0;
    transform: scale(0.8);
  }
}

.removing {
  animation: chip-exit 0.15s ease forwards;
}

/* ==========================================================================
   RTL SUPPORT
   ========================================================================== */

[dir='rtl'] .trailingAction {
  border-radius: inherit 0 0 inherit;
}

/* ==========================================================================
   HIGH CONTRAST MODE
   ========================================================================== */

@media (forced-colors: active) {
  .chip {
    border: 1px solid CanvasText;
  }

  .outline {
    border-color: CanvasText;
  }

  .focusRing {
    outline-color: Highlight;
  }

  .selected::before {
    background: Highlight;
  }

  .selected .labelText {
    color: HighlightText;
  }
}

/* ==========================================================================
   REDUCED MOTION
   ========================================================================== */

@media (prefers-reduced-motion: reduce) {
  .ripple::before,
  .ripple::after {
    transition-duration: 0.01ms;
  }

  .filter .leadingIcon {
    animation-duration: 0.01ms;
  }

  .removing {
    animation-duration: 0.01ms;
  }
}
