/**
 * @license
 * Copyright 2023 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */

/**
 * Material Design 3 Dialog Styles
 *
 * A React CSS Modules port of the official @material/web dialog styles.
 *
 * @see https://github.com/material-components/material-web/tree/main/dialog
 * @see https://m3.material.io/components/dialogs
 */

/* ==========================================================================
   CSS CUSTOM PROPERTIES (TOKENS)
   ========================================================================== */

:root {
  /* Container */
  --md-dialog-container-color: var(--md-sys-color-surface-container-high, #ece6f0);
  --md-dialog-container-shape: var(--md-sys-shape-corner-extra-large, 28px);
  
  /* Headline */
  --md-dialog-headline-color: var(--md-sys-color-on-surface, #1d1b20);
  --md-dialog-headline-font: var(--md-sys-typescale-headline-small-font, Roboto, sans-serif);
  --md-dialog-headline-size: var(--md-sys-typescale-headline-small-size, 1.5rem);
  --md-dialog-headline-line-height: var(--md-sys-typescale-headline-small-line-height, 2rem);
  --md-dialog-headline-weight: var(--md-sys-typescale-headline-small-weight, 400);
  
  /* Supporting text */
  --md-dialog-supporting-text-color: var(--md-sys-color-on-surface-variant, #49454f);
  --md-dialog-supporting-text-font: var(--md-sys-typescale-body-medium-font, Roboto, sans-serif);
  --md-dialog-supporting-text-size: var(--md-sys-typescale-body-medium-size, 0.875rem);
  --md-dialog-supporting-text-line-height: var(--md-sys-typescale-body-medium-line-height, 1.25rem);
  --md-dialog-supporting-text-weight: var(--md-sys-typescale-body-medium-weight, 400);
  
  /* Icon */
  --md-dialog-icon-color: var(--md-sys-color-secondary, #625b71);
  --md-dialog-icon-size: 24px;
  
  /* Scrim */
  --md-dialog-scrim-color: var(--md-sys-color-scrim, #000000);
}

/* ==========================================================================
   HOST CONTAINER
   ========================================================================== */

.host {
  display: contents;
  position: fixed;
  inset: 0;
  z-index: 1000;
}

.host:not([data-open]) .scrim {
  display: none;
}

.host[data-open] .scrim {
  display: flex;
}

/* ==========================================================================
   SCRIM (BACKDROP)
   ========================================================================== */

.scrim {
  background: var(--md-dialog-scrim-color);
  display: none;
  inset: 0;
  opacity: 0.32;
  pointer-events: none;
  position: fixed;
  z-index: 1;
}

/* ==========================================================================
   DIALOG ELEMENT
   ========================================================================== */

.dialog {
  background: transparent;
  border: none;
  border-radius: var(--md-dialog-container-shape);
  display: flex;
  flex-direction: column;
  height: fit-content;
  width: fit-content;
  margin: auto;
  max-height: min(560px, calc(100% - 48px));
  max-width: min(560px, calc(100% - 48px));
  min-height: 140px;
  min-width: 280px;
  outline: none;
  overflow: visible;
  padding: 0;
  position: fixed;
  z-index: 2;
}

.dialog::backdrop {
  /* Native backdrop - hidden since we use custom scrim */
  background: none;
}

.dialog:not([open]) {
  display: none;
}

/* ==========================================================================
   CONTAINER
   ========================================================================== */

.container {
  background: var(--md-dialog-container-color);
  border-radius: inherit;
  display: flex;
  flex-direction: column;
  flex-grow: 1;
  overflow: hidden;
  position: relative;
  transform-origin: top;
}

/* ==========================================================================
   HEADLINE SECTION
   ========================================================================== */

.headline {
  align-items: center;
  color: var(--md-dialog-headline-color);
  display: flex;
  flex-direction: column;
  font-family: var(--md-dialog-headline-font);
  font-size: var(--md-dialog-headline-size);
  line-height: var(--md-dialog-headline-line-height);
  font-weight: var(--md-dialog-headline-weight);
  position: relative;
}

.headlineText {
  all: unset;
  align-items: center;
  align-self: stretch;
  box-sizing: border-box;
  display: flex;
  gap: 8px;
  padding: 24px 24px 0;
}

/* ==========================================================================
   ICON
   ========================================================================== */

.icon {
  display: flex;
  justify-content: center;
  color: var(--md-dialog-icon-color);
  fill: currentColor;
  font-size: var(--md-dialog-icon-size);
  margin-top: 24px;
  height: var(--md-dialog-icon-size);
  width: 100%;
}

.icon > * {
  width: var(--md-dialog-icon-size);
  height: var(--md-dialog-icon-size);
}

/* Icon affects headline padding */
.hasIcon .headlineText {
  justify-content: center;
  padding-top: 16px;
  text-align: center;
}

/* ==========================================================================
   SCROLL INDICATORS (DIVIDERS)
   ========================================================================== */

.divider {
  display: none;
  position: absolute;
  left: 0;
  right: 0;
  height: 1px;
  background: var(--md-sys-color-outline-variant, #cac4d0);
}

.headline .divider {
  bottom: 0;
}

.actions .divider {
  top: 0;
}

/* Show dividers when scrollable */
.scrollable.hasHeadline.showTopDivider .headline .divider {
  display: flex;
}

.scrollable.hasActions.showBottomDivider .actions .divider {
  display: flex;
}

/* Adjust padding when scrollable */
.scrollable .headlineText {
  padding-bottom: 16px;
}

.scrollable.hasHeadline .content {
  padding-top: 8px;
}

/* ==========================================================================
   SCROLLER (CONTENT WRAPPER)
   ========================================================================== */

.scroller {
  display: flex;
  flex: 1;
  flex-direction: column;
  overflow: hidden;
  z-index: 1;
}

.scrollable .scroller {
  overflow-y: auto;
}

/* ==========================================================================
   CONTENT
   ========================================================================== */

.content {
  color: var(--md-dialog-supporting-text-color);
  font-family: var(--md-dialog-supporting-text-font);
  font-size: var(--md-dialog-supporting-text-size);
  line-height: var(--md-dialog-supporting-text-line-height);
  font-weight: var(--md-dialog-supporting-text-weight);
  flex: 1;
  height: min-content;
  position: relative;
  padding: 24px;
  box-sizing: border-box;
}

/* Content form wrapper */
.content form {
  margin: 0;
  padding: 0;
}

/* Reduce content bottom padding when actions exist */
.hasActions .content {
  padding-bottom: 8px;
}

/* ==========================================================================
   SCROLL ANCHORS
   ========================================================================== */

.topAnchor,
.bottomAnchor {
  position: absolute;
  width: 1px;
  height: 1px;
}

.topAnchor {
  top: 0;
}

.bottomAnchor {
  bottom: 0;
}

/* ==========================================================================
   ACTIONS SECTION
   ========================================================================== */

.actions {
  position: relative;
}

.actionsContent {
  box-sizing: border-box;
  display: flex;
  gap: 8px;
  justify-content: flex-end;
  padding: 16px 24px 24px;
}

/* ==========================================================================
   FOCUS TRAP
   ========================================================================== */

.focusTrap {
  position: absolute;
  width: 1px;
  height: 1px;
  opacity: 0;
  pointer-events: none;
}

/* ==========================================================================
   HIGH CONTRAST MODE
   ========================================================================== */

@media (forced-colors: active) {
  .dialog {
    outline: 2px solid WindowText;
  }
}

/* ==========================================================================
   DARK THEME SUPPORT
   ========================================================================== */

[data-theme="dark"] .host,
:root[data-theme="dark"] .host {
  --md-dialog-container-color: var(--md-sys-color-surface-container-high, #2b2930);
  --md-dialog-headline-color: var(--md-sys-color-on-surface, #e6e1e5);
  --md-dialog-supporting-text-color: var(--md-sys-color-on-surface-variant, #cac4d0);
  --md-dialog-icon-color: var(--md-sys-color-secondary, #ccc2dc);
  --md-dialog-scrim-color: var(--md-sys-color-scrim, #000000);
}

/* ==========================================================================
   REDUCED MOTION
   ========================================================================== */

@media (prefers-reduced-motion: reduce) {
  .dialog,
  .scrim,
  .container,
  .scroller {
    animation: none !important;
    transition: none !important;
  }
}
